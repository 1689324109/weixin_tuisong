# 挂服务器（家用电脑也可以）自动任务教程

注意：没有服务器的话，用家用电脑也可以，但是在电脑关机的情况下，无法进行自动任务。

## 首先你需要一台云服务器

`我自己用的是腾讯云服务器，购买地址为:https://cloud.tencent.com/`

购买之后安装系统镜像，我这里选择的是Windows servers 2012 R2

刚开始安装系统会要求你设置VNC登录密码，如果忘记了需要重置密码

<img src="assets/image-20220818090154426.png" alt="image-20220818090154426" style="zoom:67%;" />

在购买成功服务器的同时你还会获得一个公网ip

<img src="assets/image-20220818090316938.png" alt="image-20220818090316938" style="zoom: 50%;" />

安装好后首先要做的事情是用自己的电脑连接上服务器

## 连接服务器

<img src="assets/image-20220818090440604.png" alt="image-20220818090440604" style="zoom:67%;" />

直接在自己的电脑上搜索远程电脑连接工具

然后计算机栏填你刚刚申请的公网ip；

用户名填**Administrator**

密码填你刚刚在VNC设置的密码

填好后就能登录我们的服务器拉

## 安装python

在你的远程服务器上也需要安装python和request包还有配置系统变量，可以直接在服务器中打开浏览器安装，和在自己电脑上操作一模一样

官方网站: https://www.python.org/getit/

**记住在安装后需要配置系统环境PATH,具体教程网上可搜**

## 安装requests包

打开cmd，执行以下命令

```commandline
pip3 install requests
```

## 设置定时任务

你可以直接把你电脑里面的代码文件夹都复制进去，因为windows定时任务不能直接执行.py文件，所以我们需要创建一个.bat文件，首先我们要在服务器上创建一个文本文件（记得要放在与main.py同一个文件夹里面），在里面输入

`python main.py`

![image-20220818091253789](assets/image-20220818091253789.png)

然后进行重命名，我这里重命名为run.dat文件。该文件已经同步上传github和码云，可以直接下载。

<img src="assets/image-20220818092442366.png" alt="image-20220818092442366" style="zoom:50%;" />



然后我们就可以开心的设置定时任务啦！

在服务器上搜索`任务计划程序`

<img src="assets/image-20220818091631592.png" alt="image-20220818091631592" style="zoom:50%;" />

点击`创建基本任务`

<img src="assets/image-20220818091713590.png" alt="image-20220818091713590" style="zoom:50%;" />

名称就直接填`微信推送`就行

点击`下一步`，选择`每天`

<img src="assets/image-20220818091813969.png" alt="image-20220818091813969" style="zoom:50%;" />

这里填你每天想要推送的时间，我这里选的是早上七点四十

<img src="assets/image-20220818091938657.png" alt="image-20220818091938657" style="zoom:50%;" />

选择`启动程序`

<img src="assets/image-20220818092006914.png" alt="image-20220818092006914" style="zoom:50%;" />

然后在`程序或脚本`这里填入你运行代码的run.dat文件

记住`起始于`也要填，填你放run.dat的文件夹

文件夹地址可以直接复制

<img src="assets/image-20220818092328505.png" alt="image-20220818092328505" style="zoom:50%;" />

这一步完成后直接点击完成

但是还没有完，我们还需要设置启动程序权限

<img src="assets/image-20220818092616549.png" alt="image-20220818092616549" style="zoom:50%;" />

点击刚刚创建任务的属性

<img src="assets/image-20220818092702680.png" alt="image-20220818092702680" style="zoom:50%;" />

勾选`不管用户是否登录都要运行`和`使用最高权限运行`，配置选择你的服务器配置（用电脑的选用自己电脑配置）

全部完成后点击确定，然后输入VNC密码就可以啦！

全部完成~